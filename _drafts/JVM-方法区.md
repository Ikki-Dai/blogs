## 方法区

- 方法区和堆一样，是线程共享区域
- 方法区在JVM 启动的时候被创建，且它的实际物理空间和java 堆区一样都可以是不连续的
- 方法区的大小和堆空间一样, 可以选择固定或者可扩展
- 方法区的大小决定了系统可以保存多少个类，如果定义了太多类，会导致OOM
  - 加载大量的jar包
  - 大量动态的反射类
- 关闭方法区就会释放这个区域的内存

### 演进

- jdk7: PermSpace; jdk8 MetaSpace
- 本质上，方法区和永久代不等价， 仅仅对HotSpot 来说。 规范对如何实现不做统一要求。 JRockit/J9 没有永久代
- 永久代不是好的idea， 容易导致OOM
- JDK8 在本地内存中替代
- 元空间和永久代类似， 都是对JVM 规范中方法区的实现。区别在于，元空间不在虚拟机内存中实现